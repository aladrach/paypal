{#
/**
 * EnupalPaypal plugin for Craft CMS 3.x
 *
 * @link      https://enupal.com/
 * @copyright Copyright (c) 2018 Enupal
 */
#}

{% import "_includes/forms" as forms %}

{% set currencyOptions = craft.enupalPaypal.getCurrencyIsoOptions() %}
{% set languageOptions = craft.enupalPaypal.getLanguageOptions() %}

<div class="meta">
    <h6>{{ 'General'|t('sprout-forms') }}</h6>

    {{ forms.textField({
        first: true,
        label: "SKU <span class='info'>How youâ€™ll refer to this Paypal Button in the templates.</span>"|t('enupal-paypal'),
        id: 'sku',
        name: 'sku',
        value: paypalButton.sku,
        errors: paypalButton.getErrors('sku'),
        autofocus: true,
        required: true
    }) }}

    {{ forms.lightswitchField({
        label: "Enabled"|t('enupal-paypal'),
        id: 'enabled',
        name: 'enabled',
        on: paypalButton.enabled
    }) }}
</div>
<hr>
<div class="meta">
    <h6>{{ 'Paypal Button'|t('sprout-forms') }}</h6>
    {% set amountInput %}
    <div class="flex">
        <div class="textwrapper">
            {{ forms.text({
                label: "Amount <span class='info'>You can leave it in blank if is a donation</span>"|t('enupal-paypal'),
                id: 'amount',
                name: 'amount',
                placeholder: 'Enter amount'|t('enupal-paypal'),
                value: (paypalButton.amount == '0' ? '0'|number : (paypalButton.amount ? paypalButton.amount|number ?: ''))
            }) }}
        </div>
        <div class="textwrapper">
            {{ forms.selectField({
                id: 'currency',
                name: 'currency',
                options: currencyOptions,
                value: paypalButton.currency
            }) }}
        </div>
    </div>
    {% endset %}

    {{ forms.field({
        id: 'amount',
        label: 'Amount'|t('enupal-paypal'),
        errors: paypalButton.getErrors('amount')|merge(paypalButton.getErrors('currency')),
    }, amountInput) }}

    {{ forms.selectField({
        label: "Language <span class='info'>PayPal currently supports 18 languages</span>"|t('enupal-paypal'),
        id: 'language',
        name: 'language',
        options: languageOptions,
        value: paypalButton.language
    }) }}

    {% set stockInput %}
        <div class="flex">
            <div class="textwrapper">
                {{ forms.text({
                    id: 'quantity',
                    name: 'quantity',
                    value: (paypalButton.hasUnlimitedStock ? '' : (paypalButton.quantity == '0' ? '0': (paypalButton.quantity ? paypalButton.quantity : ''))),
                    placeholder: 'Enter stock'|t('enupal-paypal'),
                    disabled: paypalButton.hasUnlimitedStock
                }) }}
            </div>
            <div class="nowrap">
                {{ forms.checkbox({
                    id: 'unlimited-stock',
                    class: 'unlimited-stock',
                    label: 'Unlimited'|t('enupal-paypal'),
                    name: 'hasUnlimitedStock',
                    checked: paypalButton.hasUnlimitedStock,
                }) }}
            </div>
        </div>
    {% endset %}

    {{ forms.field({
        id: 'stock',
        label: 'Stock'|t('enupal-paypal'),
        errors: paypalButton.getErrors('hasUnlimitedStock')|merge(paypalButton.getErrors('quantity')),
    }, stockInput) }}
</div>
<hr>
<div class="meta">
    <h6>{{ 'Advanced'|t('sprout-forms') }}</h6>

    {{ forms.textField({
        first: true,
        label: "Button Name <span class='info'></span>"|t('enupal-paypal'),
        id: 'buttonName',
        name: 'buttonName',
        value: paypalButton.buttonName,
        errors: paypalButton.getErrors('buttonName'),
        autofocus: true,
        required: true
    }) }}

    {{ forms.textField({
        label: "Return URL <span class='info'>Redirect the user to this URL when the pay is successfully</span>"|t('enupal-paypal'),
        id: 'returnUrl',
        name: 'returnUrl',
        value: paypalButton.returnUrl,
        placeholder: '/thank-you',
        autofocus: true,
        errors: paypalButton.getErrors('returnUrl')
    }) }}

    {{ forms.textField({
        label: "Cancel URL <span class='info'>Redirect the user to this URL when they click the cancel button</span>"|t('enupal-paypal'),
        id: 'cancelUrl',
        name: 'cancelUrl',
        placeholder: '/something-went-wrong',
        value: paypalButton.cancelUrl,
        autofocus: true,
        errors: paypalButton.getErrors('cancelUrl')
    }) }}
</div>